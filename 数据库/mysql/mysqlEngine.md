## MySql存储引擎

### InnoDB（默认存储引擎）
InnoDB可以将每个表的数据和索引存放在单独的文件中，也可以使用裸设备作为表空间的存储介质。

InnoDB采用MVCC来支持高并发，并且实现了四个标准的隔离级别。其默认级别是REPEATABLE READ，并且通过间歇锁（next-key locking）策略防止幻读的出现。间歇锁使得InnoDB不仅仅锁定查询涉及的行，还会对索引中的间歇进行锁定，防止幻影行的插入。

InnoDB的表是基于聚簇索引建立的，聚簇索引的主键查询有很高的性能，不过他的二级索引必须包含主键索引的列，所以如果主键索引很大的话，那么其他索引也会很大。InnoDB的存储格式是平台独立的，也就是说可以将数据和索引文件从Intel平台复制到其他平台。

InnoDB的内部做了很多优化，包括从磁盘读取数据时采用可预测性预读，能够自动在内存中创建hash索引以加速读操作的自适应性hash索引,以及能够快速的插入操作的插入缓冲区。

作为事务型存储引擎，InnoDB通过一些机制和工具支持真正的热备份，而mysql其他存储引擎不支持热备份，要获取一致性视图需要停止对索引表的写入，而在混合读写的场景下，停止写入可能也意味着停止读取。


### MyISAM
  MyISAM提供了大量的特性，包括全文索引，压缩，空间函数等。但MyISAM不支持行锁以及事务，而且有一个缺陷就是崩溃后无法安全恢复，对于一些只读的数据，或者表比较小，可以忍受修复操作，也是可以使用MyISAM。但不建议。
  
  MyISAM会将数据存储在两个文件中，索引文件和数据文件，分别以.MYI,.MYD为扩展名，MyISAM可以包含动态或者静态（长度固定）的行，MySQL会根据表的定义决定采用哪种给格式
 
  MyISAM对整张表加锁，而不是针对行，读取时会对需要读到的所有表加共享锁，写入时则对表加排他锁。但是在有表读取的时候也可以往表中插入数据（并发插入）
  
  对于MyISAM来讲，即使时blog和text这样的长字段，也可以基于前500个字符创建索引。MyISAM也支持全文索引，这是一种基于分词创建的索引，可以支持复杂的查询。
  
  延迟更新索引键，创建MyISAM的时候，如果制定了DELAY_KEY_WRITE选项，在每次修改执行完成时，不会立即将修改的索引写入磁盘，而是会写进内存中的键缓冲区，只有在清理键缓冲区或者关闭表的时候才会将对应的索引写入磁盘，这种方式可以极大的提升性能，但是在数据库崩溃的时候会造成索引损坏，需要执行修复操作。延迟更新索引键的特性，可以在全局键设置，也可以为单个表设置。
  
  MyISAM压缩表:仅仅适用于创建并且倒入数据之后不会再进行修改的数据，可以极大的减少磁盘空间占用，因此也可以减少磁盘IO，从而提升查询性能，压缩表也支持索引，但是索引是只读的。
  
  MyISAM引擎设计简单，数据以紧密格式存储，所以在某些场景下性能很好，MyISAM有一些服务器级别的性能扩展限制，比如索引键缓冲区的Mutex锁，MariaDB基于段的索引键缓冲机制来避免此问题，但MyISAM最典型的毫无疑问还是表锁的问题，如果你发现所有的查询都长期处于Locked状态，那么毫无疑问表锁就是罪魁祸首。